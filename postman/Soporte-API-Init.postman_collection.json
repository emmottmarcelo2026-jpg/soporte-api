{
  "info": {
    "_postman_id": "soporte-api-init",
    "name": "Soporte API - Emmott Systems",
    "description": "Colecci贸n completa para el sistema de soporte Emmott Systems. Incluye inicializaci贸n, autenticaci贸n y CRUD completo.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{jwt_token}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:4000",
      "type": "string"
    },
    {
      "key": "jwt_token",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. Crear Roles (Ejecutar primero)",
      "item": [
        {
          "name": "1.1 Crear Rol ADMIN",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"ADMIN\",\n  \"description\": \"Administrador del sistema\"\n}"
            },
            "url": { "raw": "{{baseUrl}}/roles", "host": ["{{baseUrl}}"], "path": ["roles"] }
          }
        },
        {
          "name": "1.2 Crear Rol SUPERVISOR",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"SUPERVISOR\",\n  \"description\": \"Supervisor de 谩rea\"\n}" },
            "url": { "raw": "{{baseUrl}}/roles", "host": ["{{baseUrl}}"], "path": ["roles"] }
          }
        },
        {
          "name": "1.3 Crear Rol ANALYST",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"ANALYST\",\n  \"description\": \"Analista de soporte\"\n}" },
            "url": { "raw": "{{baseUrl}}/roles", "host": ["{{baseUrl}}"], "path": ["roles"] }
          }
        },
        {
          "name": "1.4 Crear Rol QA",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"QA\",\n  \"description\": \"Analista de calidad (QA)\"\n}" },
            "url": { "raw": "{{baseUrl}}/roles", "host": ["{{baseUrl}}"], "path": ["roles"] }
          }
        },
        {
          "name": "1.5 Crear Rol DEVELOPER",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"DEVELOPER\",\n  \"description\": \"Desarrollador de software\"\n}" },
            "url": { "raw": "{{baseUrl}}/roles", "host": ["{{baseUrl}}"], "path": ["roles"] }
          }
        },
        {
          "name": "1.6 Listar Roles",
          "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/roles", "host": ["{{baseUrl}}"], "path": ["roles"] } }
        }
      ]
    },
    {
      "name": "2. Crear reas (Ejecutar segundo)",
      "item": [
        {
          "name": "2.1 Crear rea Soporte",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"Soporte\",\n  \"description\": \"rea de soporte t茅cnico\"\n}" },
            "url": { "raw": "{{baseUrl}}/areas", "host": ["{{baseUrl}}"], "path": ["areas"] }
          }
        },
        {
          "name": "2.2 Crear rea Desarrollo",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"Desarrollo de Software\",\n  \"description\": \"rea de desarrollo de software\"\n}" },
            "url": { "raw": "{{baseUrl}}/areas", "host": ["{{baseUrl}}"], "path": ["areas"] }
          }
        },
        {
          "name": "2.3 Crear rea Marketing",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"Marketing\",\n  \"description\": \"rea de marketing\"\n}" },
            "url": { "raw": "{{baseUrl}}/areas", "host": ["{{baseUrl}}"], "path": ["areas"] }
          }
        },
        {
          "name": "2.4 Crear rea Finanzas",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"Finanzas\",\n  \"description\": \"rea de finanzas\"\n}" },
            "url": { "raw": "{{baseUrl}}/areas", "host": ["{{baseUrl}}"], "path": ["areas"] }
          }
        },
        {
          "name": "2.5 Crear rea RRHH",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"Recursos Humanos\",\n  \"description\": \"rea de recursos humanos\"\n}" },
            "url": { "raw": "{{baseUrl}}/areas", "host": ["{{baseUrl}}"], "path": ["areas"] }
          }
        },
        {
          "name": "2.6 Listar reas",
          "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/areas", "host": ["{{baseUrl}}"], "path": ["areas"] } }
        }
      ]
    },
    {
      "name": "3.  Autenticaci贸n",
      "item": [
        {
          "name": "3.1  Setup Inicial (Crear primer Admin)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.access_token) {",
                  "    pm.collectionVariables.set('jwt_token', jsonData.access_token);",
                  "    console.log('Token guardado autom谩ticamente');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": { "type": "noauth" },
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"firstName\": \"Admin\",\n  \"lastName\": \"Sistema\",\n  \"email\": \"admin@emmott.cl\",\n  \"password\": \"AdminPassword123\"\n}"
            },
            "url": { "raw": "{{baseUrl}}/auth/setup", "host": ["{{baseUrl}}"], "path": ["auth", "setup"] }
          }
        },
        {
          "name": "3.2 Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.access_token) {",
                  "    pm.collectionVariables.set('jwt_token', jsonData.access_token);",
                  "    console.log('Token guardado autom谩ticamente');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": { "type": "noauth" },
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"admin@emmott.cl\",\n  \"password\": \"AdminPassword123\"\n}"
            },
            "url": { "raw": "{{baseUrl}}/auth/login", "host": ["{{baseUrl}}"], "path": ["auth", "login"] }
          }
        },
        {
          "name": "3.3 Mi Perfil (Requiere Auth)",
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{baseUrl}}/auth/profile", "host": ["{{baseUrl}}"], "path": ["auth", "profile"] }
          }
        },
        {
          "name": "3.4 Registrar Usuario (Requiere Auth)",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"firstName\": \"Juan\",\n  \"lastName\": \"P茅rez\",\n  \"email\": \"juan.perez@emmott.cl\",\n  \"password\": \"JuanPassword123\",\n  \"rut\": \"12345678-9\",\n  \"roleId\": 5,\n  \"areaId\": 2\n}"
            },
            "url": { "raw": "{{baseUrl}}/auth/register", "host": ["{{baseUrl}}"], "path": ["auth", "register"] }
          }
        }
      ]
    },
    {
      "name": "4. Usuarios",
      "item": [
        {
          "name": "4.1 Listar Usuarios",
          "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/usuarios", "host": ["{{baseUrl}}"], "path": ["usuarios"] } }
        },
        {
          "name": "4.2 Obtener Usuario por ID",
          "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/usuarios/1", "host": ["{{baseUrl}}"], "path": ["usuarios", "1"] } }
        }
      ]
    },
    {
      "name": "5. Verificar Sistema",
      "item": [
        {
          "name": "5.1 Listar Roles",
          "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/roles", "host": ["{{baseUrl}}"], "path": ["roles"] } }
        },
        {
          "name": "5.2 Listar reas",
          "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/areas", "host": ["{{baseUrl}}"], "path": ["areas"] } }
        },
        {
          "name": "5.3 Listar Usuarios",
          "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/usuarios", "host": ["{{baseUrl}}"], "path": ["usuarios"] } }
        }
      ]
    }
  ]
}
